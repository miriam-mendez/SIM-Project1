setwd("C:/Gabriel/Git Workspace/SIM-Project1")
df <- read.csv("insurance.csv")
summary(df)
View(df)
df[df == ''] <- NA
summary(df)
mis_col = colSums(is.na(df))
mis_col
df[df == ''] <- NA
mis_col = colSums(is.na(df))
mis_col
duplicated(df)
df[duplicated(df), ]
df[!duplicated(df), ]
nrow(df)
df <- df[!duplicated(df), ]
nrow(df)
lapply(df, class)
categ_cols <- c( 'sex', 'smoker', 'region')
df[categ_cols] = lapply(df[categ_cols], FUN = as.factor)
lapply(df, class)
summary(df)
Boxplot(df$bmi)
requiredPackages <- c("missMDA","effects","FactoMineR","car","factoextra","RColorBrewer","ggplot2","dplyr","ggmap","ggthemes","knitr","chemometrics","rpart","ROCR","corrr","readxl","RColorBrewer","ggplot2","corrplot","plotly","xlsx","reshape2","scales","stargazer","kableExtra")
package.check <- lapply(requiredPackages, FUN = function(x) {
if (!require(x, character.only = TRUE)) {
install.packages(x, dependencies = TRUE)
library(x, character.only = TRUE)
}
})
Boxplot(df$bmi)
summary(df)
View(df)
ss<-summary(df$age);ss
# Upper/lower severe threshold
utso2<-ss[5]+3*(ss[5]-ss[2]);utso2
utsi2<-ss[2]-3*(ss[5]-ss[2]);utsi2
# Upper/lower mild threshold
utmo2<-ss[5]+1.5*(ss[5]-ss[2]);utmo2
utmi2<-ss[2]-1.5*(ss[5]-ss[2]);utmi2
Boxplot(df$age,id=list(n=Inf,labels=row.names(df)))
Boxplot(df$age)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
abline(h=utmo2,col="green",lwd=3)
abline(h=utmi2,col="green",lwd=3)
Boxplot(df$age,id=list(n=Inf,labels=row.names(df)))
Boxplot(df$age)
Boxplot(df)
Boxplot(df[,c(1,3,4,7)])
Boxplot(df[,c(1,3,4)])
Boxplot(df[,c(7)])
Boxplot(df[,c(3,7)])
Boxplot(df$bmi)
Boxplot(df$charges)
ss<-summary(df$bmi);ss
# Upper/lower severe threshold
utso2<-ss[5]+3*(ss[5]-ss[2]);utso2
utsi2<-ss[2]-3*(ss[5]-ss[2]);utsi2
# Upper/lower mild threshold
utmo2<-ss[5]+1.5*(ss[5]-ss[2]);utmo2
utmi2<-ss[2]-1.5*(ss[5]-ss[2]);utmi2
Boxplot(df$bmi,id=list(n=Inf,labels=row.names(df)))
Boxplot(df$bmi)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
abline(h=utmo2,col="green",lwd=3)
abline(h=utmi2,col="green",lwd=3)
Boxplot(df[,c(1,4)])
Boxplot(df[,c(1,3,4)])
Boxplot(df$bmi~df$charges,id=list(n=Inf,labels=row.names(df)),col=heat.colors(2))
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
Boxplot(df$bmi~df$sex,id=list(n=Inf,labels=row.names(df)),col=heat.colors(2))
lls<-which((df$rm>utso2)|(df$rm<utsi2));lls
df[lls,]
llm<-which((df$rm>utmo2)|(df$rm<utmi2));llm
par(mfrow=c(1,1))
Boxplot(df$bmi,id=list(n=Inf,labels=row.names(df)))
Boxplot(df$bmi)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
abline(h=utmo2,col="green",lwd=3)
abline(h=utmi2,col="green",lwd=3)
llm<-which((df$rm>utmo2)|(df$rm<utmi2));llm
lls<-which((df$rm>utso2)|(df$rm<utsi2));lls
llm<-which((df$rm>utmo2)|(df$rm<utmi2));llm
df[llm,]
par(mfrow=c(1,1))
lls<-which((df$bmi>utso2)|(df$bmi<utsi2));lls
llm<-which((df$bmi>utmo2)|(df$bmi<utmi2));llm
ss<-summary(df$charges);ss
# Upper/lower severe threshold
utso2<-ss[5]+3*(ss[5]-ss[2]);utso2
utsi2<-ss[2]-3*(ss[5]-ss[2]);utsi2
# Upper/lower mild threshold
utmo2<-ss[5]+1.5*(ss[5]-ss[2]);utmo2
utmi2<-ss[2]-1.5*(ss[5]-ss[2]);utmi2
Boxplot(df$charges,id=list(n=Inf,labels=row.names(df)))
Boxplot(df$charges)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
abline(h=utmo2,col="green",lwd=3)
abline(h=utmi2,col="green",lwd=3)
lls<-which((df$charges>utso2)|(df$charges<utsi2));lls
df[lls,]
llm<-which((df$charges>utmo2)|(df$charges<utmi2));llm
df[llm,]
par(mfrow=c(1,1))
df[lls,]
df[lls,"charges"]<-NA
summary(df$charges)
mis_col = colSums(is.na(df))
mis_col
#Only charges has missing data (outliers)
imres<-imputePCA(df[c(1,3,4,7)])
#Only charges has missing data (outliers)
imres<-imputePCA(df[c(1,3,4,7)])
names(imres)
imres$completeObs[lls,"charges"]
Boxplot(imres$completeObs[,"charges"])
Boxplot(df$charges)
par(mfrow=c(1,2))
Boxplot(imres$completeObs[,"charges"])
Boxplot(df$charges)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
df[lls,"charges"]<-imres$completeObs[lls,"charges"]
Boxplot(imres$completeObs[,"charges"])
Boxplot(df$charges)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
Boxplot(imres$completeObs[,"charges"])
Boxplot(df$charges)
library(chemometrics)
lapply(df[ ,3:9],table)
res.mout <- Moutlier( df[ , c(4:9)], quantile = 0.999 )
lapply(df[ ,1,3,4,7],table)
lapply(df[ ,c(1,3,4,7)],table)
res.mout <- Moutlier( df[ , c(1,3,4,7)], quantile = 0.999 )
par(mfrow=c(1,1))
res.mout <- Moutlier( df[ , c(1,3,4,7)], quantile = 0.999 )
par(mfrow=c(1,1))
plot( res.mout$md, res.mout$rd )
abline( h=res.mout$cutoff, lwd=2, col="red")
abline( v=res.mout$cutoff, lwd=2, col="red")
llmout <- which( ( res.mout$md > res.mout$cutoff ) & (res.mout$rd > res.mout$cutoff) );llmout
df[llmout,]
res.mout$md[llmout]
llmout
df[llmout,]
res.mout$md[llmout]
llmout
df[llmout,]
#Since there is only one multivariate outlier, we delete it
df <- df[-llmout,]
summary(df)
plot(df$charges~df$sex)
barplot(df$charges~df$sex)
ss<-summary(df$bmi);ss
# Upper/lower severe threshold
utso2<-ss[5]+3*(ss[5]-ss[2]);utso2
utsi2<-ss[2]-3*(ss[5]-ss[2]);utsi2
# Upper/lower mild threshold
utmo2<-ss[5]+1.5*(ss[5]-ss[2]);utmo2
utmi2<-ss[2]-1.5*(ss[5]-ss[2]);utmi2
Boxplot(df$bmi,id=list(n=Inf,labels=row.names(df)))
Boxplot(df$bmi)
abline(h=utso2,col="red",lwd=3)
abline(h=utsi2,col="red",lwd=3)
abline(h=utmo2,col="green",lwd=3)
#117  287  402  544  847  860 1087 1316
df(1316,)
#117  287  402  544  847  860 1087 1316
df[1316,]
#117  287  402  544  847  860 1087 1316
df[c(117  ,287  ,402  ,544  ,847,860,1087,1316),]
nrow(df)
8/nrow(df)*100
#Checking bmi mild outliers
df[c(117,287,402,544,847,860,1087,1316),]
df <- df[-c(847,1316),]
